import{S as w}from"./sweetalert2.esm.all-D3pEHXw3.js";import{_ as v,b as g,o as d,c,e as t,F as p,r as _,n as y,t as a,d as h,l as x,g as f}from"./index-BwxbVr64.js";import{S as $}from"./swiper-bundle-CUnLjt9d.js";const C={data(){return{products:[]}},methods:{fetchProducts(){this.isLoading=!0,g.get("https://vue3-course-api.hexschool.io/api/tingg-api/products/all").then(e=>{const o=JSON.parse(localStorage.getItem("favorites"))||[];this.products=e.data.products.map(u=>({...u,isFavorite:o.includes(u.id)})),this.isLoading=!1}).catch(e=>{console.error("無法獲取產品資料",e)})},goProductDetail(s){this.$router.push(`/user/product/${s}`)},toggleFavorite(s){s.isFavorite=!s.isFavorite,console.log(s.id);const e=JSON.parse(localStorage.getItem("favorites"))||[];if(s.isFavorite)e.push(s.id);else{const o=e.indexOf(s.id);o!==-1&&e.splice(o,1)}localStorage.setItem("favorites",JSON.stringify(e))}},computed:{displayedProducts(){return this.products.slice().sort(()=>.5-Math.random()).slice(0,6)}},mounted(){this.fetchProducts(),new $(".swiper",{speed:400,spaceBetween:5,grabCursor:!0,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},pagination:{el:".swiper-pagination",clickable:!0},breakpoints:{1600:{slidesPerView:4},1200:{slidesPerView:3},768:{slidesPerView:2},390:{slidesPerView:1}}})}},P={class:"container mb-3"},k={class:"swiper"},S={class:"swiper-wrapper"},q={class:"card",style:{width:"18rem"}},F=["onClick"],L=["onClick"],N=["src","alt"],D={class:"card-body"},I={class:"card-title text-center"},V={class:"d-flex align-items-center justify-content-between"},T={class:"card-text text-danger"},B=["onClick"];function O(s,e,o,u,i,n){return d(),c(p,null,[e[4]||(e[4]=t("hr",null,null,-1)),t("div",P,[e[3]||(e[3]=t("h2",{class:"my-5 fw-bold text-center"},"您可能會喜歡的商品",-1)),t("div",k,[t("div",S,[(d(!0),c(p,null,_(n.displayedProducts,(l,m)=>(d(),c("div",{class:"swiper-slide",key:m},[t("div",q,[t("i",{class:y(l.isFavorite?"bi bi-suit-heart-fill text-danger favorite-btn":"bi bi-suit-heart favorite-btn"),onClick:r=>n.toggleFavorite(l)},null,10,F),t("button",{class:"btn",onClick:r=>n.goProductDetail(l.id)},[t("img",{src:l.imageUrl,alt:l.title,class:"card-img-top"},null,8,N)],8,L),t("div",D,[t("h5",I,a(l.title),1),t("div",V,[t("h5",T," $NT"+a(s.$filters.currency(l.price)),1),t("button",{class:"btn bg-secondary text-white",onClick:r=>n.goProductDetail(l.id)}," 查看商品 ",8,B)])])])]))),128))]),e[0]||(e[0]=t("div",{class:"swiper-pagination"},null,-1)),e[1]||(e[1]=t("div",{class:"swiper-button-next"},null,-1)),e[2]||(e[2]=t("div",{class:"swiper-button-prev"},null,-1))])])],64)}const E=v(C,[["render",O],["__scopeId","data-v-820f801d"]]),J={data(){return{newContent:[],quantity:1,product:{},isLoading:!1,cartAdded:!1}},components:{ProductSwiper:E},watch:{"$route.params.ProductId"(s){this.getProductDetail(s)}},methods:{increase(){this.quantity++},decrease(){this.quantity>1&&this.quantity--},getProductDetail(){const e=`https://vue3-course-api.hexschool.io/api/tingg-api/product/${this.$route.params.ProductId}`;g.get(e).then(o=>{this.isLoading=!1,this.product=o.data.product,this.newContent=this.product.content.split(","),console.log(this.newContent)})},addToCart(s){g.post("https://vue3-course-api.hexschool.io/api/tingg-api/cart",{data:{product_id:s,qty:this.quantity}}).then(o=>{console.log("商品已加入購物車:",o),this.cartAdded=!0,w.fire({title:"成功",text:"商品已成功加入購物車",icon:"success"})}).catch(o=>{console.error("加入購物車失敗:",o)})}},mounted(){this.isLoading=!0,this.getProductDetail()}},j={class:"container mt-5 d-flex justify-content-center"},A={class:"d-flex flex-column flex-md-row"},U=["src"],z={class:"product-details ms-md-2 mt-3 mt-md-0"},M={class:"product-title mb-3 fw-bold"},G={class:"product-subtitle mb-3"},H={class:"d-flex"},K={key:0,class:"price mb-4 me-3"},Q={class:"price text-danger mb-4"},R={class:"quantity-selector d-flex align-items-center"},W=["disabled"],X={class:"mx-3 quantity-display"},Y={class:"mt-3"},Z={class:"container"};function tt(s,e,o,u,i,n){const l=f("Loading"),m=f("ProductSwiper");return d(),c(p,null,[h(l,{active:i.isLoading,loader:"bars",color:"#e9e9d7"},null,8,["active"]),t("div",j,[t("div",A,[t("img",{src:i.product.imageUrl,class:"product-image me-5",alt:"商品圖片"},null,8,U),t("div",z,[t("h1",M,a(i.product.title),1),t("h6",G,a(i.product.description),1),e[4]||(e[4]=t("ul",{class:"list-unstyled"},[t("li",null,"物品狀況：全新"),t("li",null,"物品所在地: 新北市")],-1)),t("div",H,[i.product.origin_price>i.product.price?(d(),c("h5",K,[t("del",null,"NT$:"+a(s.$filters.currency(i.product.origin_price)),1)])):x("",!0),t("h5",Q," NT$:"+a(s.$filters.currency(i.product.price)),1)]),t("div",R,[e[3]||(e[3]=t("p",{class:"mt-3 me-2"},"數量:",-1)),t("button",{class:"btn btn-outline-secondary quantity-btn",onClick:e[0]||(e[0]=(...r)=>n.decrease&&n.decrease(...r)),disabled:i.quantity<=1}," - ",8,W),t("span",X,a(i.quantity),1),t("button",{class:"btn btn-outline-secondary quantity-btn",onClick:e[1]||(e[1]=(...r)=>n.increase&&n.increase(...r))}," + ")]),t("div",Y,[t("button",{class:"btn btn-outline-secondary add-to-cart-btn",onClick:e[2]||(e[2]=r=>n.addToCart(i.product.id))}," 加入購物車 ")])])])]),t("div",Z,[e[5]||(e[5]=t("hr",null,null,-1)),e[6]||(e[6]=t("h2",{class:"fw-bold my-3"},"商品規格",-1)),t("ol",null,[(d(!0),c(p,null,_(i.newContent,(r,b)=>(d(),c("li",{key:b},[t("p",null,a(r),1)]))),128))]),e[7]||(e[7]=t("h2",{class:"fw-bold my-3"},"購物須知",-1)),e[8]||(e[8]=t("ol",null,[t("li",null,[t("p",null," 商品圖片為實物拍攝，因拍攝光線、顯示器差異等因素，商品圖片可能會與實際商品略有不同，實際顏色以收到商品為準。 ")]),t("li",null,[t("p",null," 訂單確認後，商品將於1-3個工作天內處理並安排出貨。若遇上假日或特殊情況（如節慶促銷），處理時間可能會稍有延遲。 ")]),t("li",null,[t("p",null,"商品尺寸為手工測量，可能有±2公分的誤差，請確認所需尺寸後再下單。")]),t("li",null,[t("p",null," 消費滿一定金額可享免運優惠，未達標準之訂單則需支付相應運費，具體標準請參考網站配送政策。 ")]),t("li",null,[t("p",null," 我們提供完整的售後服務，若在商品使用過程中遇到任何問題，歡迎隨時聯繫客服，我們將盡力協助解決。 ")])],-1))]),h(m)],64)}const ot=v(J,[["render",tt],["__scopeId","data-v-64ef82ed"]]);export{ot as default};
