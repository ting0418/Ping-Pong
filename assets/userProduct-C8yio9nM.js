import{_ as f,o as r,c,a as C,e as s,F as m,r as b,n as L,t as l,b as y,d as p,f as x,v as $,g,l as k}from"./index-BwxbVr64.js";import{S as I}from"./swiper-bundle-CUnLjt9d.js";import{P as S}from"./Pagination-D4ieh_ek.js";import{S as h}from"./sweetalert2.esm.all-D3pEHXw3.js";const F="/Ping-Pong/assets/2-wyFgniOD.webp",T="/Ping-Pong/assets/3-DObRXOAT.jpg",B={mounted(){new I(".swiper",{speed:400,spaceBetween:100,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},pagination:{el:".swiper-pagination",clickable:!0},loop:!0,autoplay:{delay:3e3,disableOnInteraction:!1}})}},N={class:"swiper"};function O(t,e,n,u,o,a){return r(),c("div",N,e[0]||(e[0]=[C('<div class="swiper-wrapper" data-v-be2ca4ed><div class="swiper-slide" data-v-be2ca4ed><img src="'+F+'" alt="" data-v-be2ca4ed></div><div class="swiper-slide" data-v-be2ca4ed><img src="'+T+'" alt="" data-v-be2ca4ed></div></div><div class="swiper-pagination" data-v-be2ca4ed></div><div class="swiper-button-next" data-v-be2ca4ed></div><div class="swiper-button-prev" data-v-be2ca4ed></div>',4)]))}const j=f(B,[["render",O],["__scopeId","data-v-be2ca4ed"]]),E={props:{selectedCategory:{type:String,default:"全部商品"}},data(){return{selectedItem:this.selectedCategory||"全部商品",menuItems:["全部商品","球皮","球鞋","球拍","配件"]}},methods:{selectCategory(t){this.selectedItem=t,this.$emit("category-selected",this.selectedItem)}}},V={class:"mt-5"},q={class:"list-unstyled bg-color rounded p-3"},D=["onClick"],J={class:"menu-link fw-bold cursor-pointer"};function U(t,e,n,u,o,a){return r(),c("div",V,[s("ul",q,[(r(!0),c(m,null,b(o.menuItems,d=>(r(),c("li",{key:d,class:L([{active:o.selectedItem===d},"menu-item text-center"]),onClick:v=>a.selectCategory(d)},[s("a",J,l(d),1)],10,D))),128))])])}const A=f(E,[["render",U],["__scopeId","data-v-febe78e1"]]),M={components:{Swiper:j,Category:A,Pagination:S},data(){return{pagination:{current_page:1,per_page:9,total_pages:0},category:"全部商品",filteredProductList:[],searchInput:"",productList:[],isLoading:!0}},computed:{paginatedProducts(){const t=(this.pagination.current_page-1)*this.pagination.per_page,e=t+this.pagination.per_page;return this.filteredProductList.slice(t,e)}},methods:{updatePage(t){this.pagination.current_page=t,this.$forceUpdate()},updateTotalPages(){this.pagination.total_pages=Math.ceil(this.filteredProductList.length/this.pagination.per_page)},filterByCategory(t){this.category=t,t==="全部商品"?this.filteredProductList=this.productList:(this.filteredProductList=this.productList.filter(e=>e.category===t),this.pagination.current_page=1),this.updateTotalPages()},searchProduct(){const t=this.searchInput.toLowerCase();this.searchInput="",this.isLoading=!0,setTimeout(()=>{this.filteredProductList=this.productList.filter(e=>e.title.toLowerCase().includes(t)),this.filteredProductList.length||h.fire({title:"失敗",text:"查無此商品，看看其他商品吧!",icon:"error"}).then(()=>{this.getProductList()}),this.isLoading=!1,this.updateTotalPages()},500)},getProductList(){y.get("https://vue3-course-api.hexschool.io/api/tingg-api/products/all").then(e=>{const n=JSON.parse(localStorage.getItem("favorites"))||[];this.productList=e.data.products.map(o=>({...o,isFavorite:n.includes(o.id)})),this.filteredProductList=this.productList,this.isLoading=!1;const u=this.$route.query.category;u&&this.filterByCategory(u),this.updateTotalPages()}).catch(e=>{console.error("API 請求失敗:",e),this.isLoading=!1})},getProduct(t){this.$router.push(`/user/product/${t}`)},addToCart(t){y.post("https://vue3-course-api.hexschool.io/api/tingg-api/cart",{data:{product_id:t,qty:1}}).then(n=>{h.fire({title:"成功",text:"商品已成功加入購物車",icon:"success"})})},toggleFavorite(t){t.isFavorite=!t.isFavorite;const e=JSON.parse(localStorage.getItem("favorites"))||[];if(t.isFavorite)e.push(t.id),h.fire({title:"成功",text:"商品已成功加入收藏",icon:"success"});else{const n=e.indexOf(t.id);n!==-1&&(e.splice(n,1),h.fire({title:"成功",text:"商品已成功取消收藏",icon:"success"}))}localStorage.setItem("favorites",JSON.stringify(e)),this.filteredProductList=[...this.productList]}},watch:{filteredProductList(){this.updateTotalPages()},"$route.query.category"(t){this.filterByCategory(t||"全部商品")}},created(){this.getProductList();const t=this.$route.query.category;t&&this.filterByCategory(t)}},Q={class:"container"},z={class:"d-flex justify-content-center align-items-center mt-5"},R={class:"me-md-5 me-1 fw-bold"},X={class:"container"},G={class:"row justify-content-center"},H={class:"col-10 mt-4"},K={class:"row"},W={class:"card mx-2",style:{width:"100%",height:"auto"}},Y=["onClick"],Z=["src"],tt={class:"card-body"},et={class:"card-title fw-bolder"},st={class:"border border-warning rounded-3 px-1"},it={class:"d-flex justify-content-around my-3"},ot={class:"btn custom-button bg-light rounded-3"},at=["onClick"],rt=["onClick"],ct={key:0,class:"bi bi-heart fs-3 cursor-pointer"},nt={key:1,class:"bi bi-suit-heart-fill fs-3 text-danger"},dt={key:0,class:"text-dark"},lt={class:"d-flex align-items-center justify-content-between"},ut={class:"text-danger"},pt=["onClick"];function gt(t,e,n,u,o,a){const d=g("Loading"),v=g("Swiper"),P=g("Category"),w=g("Pagination");return r(),c("div",Q,[p(d,{active:o.isLoading,loader:"bars",color:"#e9e9d7"},null,8,["active"]),p(v,{class:"my-5"}),s("div",z,[s("h3",R,l(o.category),1),x(s("input",{type:"text",class:"form-control w-50 h-50","onUpdate:modelValue":e[0]||(e[0]=i=>o.searchInput=i)},null,512),[[$,o.searchInput]]),s("button",{class:"btn btn-outline-success ms-2",onClick:e[1]||(e[1]=i=>a.searchProduct())}," 查詢 ")]),s("div",X,[s("div",G,[p(P,{class:"col-md-2",selectedCategory:o.category,onCategorySelected:a.filterByCategory},null,8,["selectedCategory","onCategorySelected"]),s("div",H,[s("div",K,[(r(!0),c(m,null,b(a.paginatedProducts,i=>(r(),c("div",{class:"col-12 col-md-6 col-lg-4 mb-4",key:i.id},[s("div",W,[s("button",{class:"border border-0",onClick:_=>a.getProduct(i.id)},[s("img",{src:i.imageUrl,class:"card-img-top",alt:"Product Image"},null,8,Z)],8,Y),s("div",tt,[s("h5",et,l(i.title),1),s("span",st,l(i.category),1),s("div",it,[s("button",ot,[s("i",{class:"bi bi-cart fs-3",onClick:_=>a.addToCart(i.id)},null,8,at)]),s("button",{class:"btn bg-light rounded-3",onClick:_=>a.toggleFavorite(i)},[i.isFavorite?(r(),c("i",nt)):(r(),c("i",ct))],8,rt)]),i.origin_price>i.price?(r(),c("h5",dt,[s("del",null,"$NT"+l(t.$filters.currency(i.origin_price)),1)])):k("",!0),s("div",lt,[s("h5",ut," $NT"+l(t.$filters.currency(i.price)),1),s("button",{class:"btn btn-outline-dark",onClick:_=>a.getProduct(i.id)}," 更多資訊 ",8,pt)])])])]))),128))])])])]),p(w,{pages:o.pagination,onEmitPages:a.updatePage},null,8,["pages","onEmitPages"])])}const yt=f(M,[["render",gt],["__scopeId","data-v-125896a7"]]);export{yt as default};
